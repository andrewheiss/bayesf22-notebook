{
  "hash": "548e8bd7dccd227ac860fa65fbf49463",
  "result": {
    "markdown": "---\ntitle: \"3: The Beta-Binomial Bayesian Model\"\nsubtitle: \"Reading notes\"\ndate: \"September 5, 2022\"\n---\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(bayesrules)\nlibrary(tidyverse)\nlibrary(extraDistr)\nlibrary(brms)\nlibrary(tidybayes)\n\n# Plot stuff\nclrs <- MetBrewer::met.brewer(\"Lakota\", 6)\ntheme_set(theme_bw())\n\n# Seed stuff\nBAYES_SEED <- 1234\nset.seed(1234)\n```\n:::\n\n\n# 3.1: Beta prior model\n\n$$\n\\pi \\sim \\operatorname{Beta}(45, 55)\n$$\n\n\n::: {.cell layout-ncol=\"2\"}\n\n```{.r .cell-code}\nggplot() +\n  geom_function(fun = ~dbeta(., 45, 55), n = 1001) +\n  labs(title = \"dbeta(45, 55)\")\n```\n\n::: {.cell-output-display}\n![](03-chapter_files/figure-html/unnamed-chunk-2-1.png){width=384}\n:::\n\n```{.r .cell-code}\n\nggplot() +\n  geom_function(fun = ~dprop(., mean = 0.45, size = 100), n = 1001) +\n  labs(title = \"dprop(0.45, 100)\")\n```\n\n::: {.cell-output-display}\n![](03-chapter_files/figure-html/unnamed-chunk-2-2.png){width=384}\n:::\n:::\n\n\n# 3.2: Binomial data model and likelihood\n\n$$\nY \\mid \\pi = \\operatorname{Binomial}(50, \\pi)\n$$\n\n# 3.3: Beta posterior model\n\n$$\n\\begin{aligned}\nY \\mid \\pi &= \\operatorname{Binomial}(50, \\pi) \\\\\n\\pi &\\sim \\operatorname{Beta}(45, 55)\n\\end{aligned}\n$$\n\n\n::: {.cell hash='03-chapter_cache/html/model-election_3ef4725f9e971a890a9f7cb6c05fc671'}\n\n```{.r .cell-code}\nmodel_election <- brm(\n  bf(support | trials(n_in_poll) ~ 0 + Intercept),\n  data = list(support = 30, n_in_poll = 50),\n  family = binomial(link = \"identity\"),\n  prior(beta(45, 55), class = b, lb = 0, ub = 1),\n  iter = 5000, warmup = 1000, seed = BAYES_SEED,\n  backend = \"rstan\", cores = 4\n)\n## Compiling Stan program...\n## Start sampling\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nmodel_election %>% \n  gather_draws(b_Intercept) %>% \n  ggplot(aes(x = .value)) +\n  stat_halfeye(fill = clrs[6]) +\n  labs(x = \"π\", title = \"Plausible values of π that could produce\\na poll where 30/50 voters support Michelle\")\n## Warning: Using the `size` aesthietic with geom_segment was deprecated in ggplot2 3.4.0.\n## ℹ Please use the `linewidth` aesthetic instead.\n```\n\n::: {.cell-output-display}\n![](03-chapter_files/figure-html/unnamed-chunk-3-1.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nmodel_election %>% \n  gather_draws(b_Intercept) %>% \n  ggplot(aes(x = .value)) +\n  geom_density(aes(fill = \"Posterior\"), color = NA, alpha = 0.75) +\n  stat_function(geom = \"area\", fun = ~dbeta(., 45, 55), aes(fill = \"Beta(45, 55) prior\"), alpha = 0.75) +\n  scale_fill_manual(values = clrs[5:6])\n```\n\n::: {.cell-output-display}\n![](03-chapter_files/figure-html/unnamed-chunk-4-1.png){width=672}\n:::\n:::\n\n\n\n# Milgram's experiment\n\n$$\n\\begin{aligned}\nY \\mid \\pi &= \\operatorname{Binomial}(40, \\pi) \\\\\n\\pi &\\sim \\operatorname{Beta}(1, 10)\n\\end{aligned}\n$$\n\n\n::: {.cell hash='03-chapter_cache/html/model-milgram_56817c38e04c17414b7da8f7c8751b7b'}\n\n```{.r .cell-code}\nmodel_milgram <- brm(\n  bf(obey | trials(participants) ~ 0 + Intercept),\n  data = list(obey = 26, participants = 40),\n  family = binomial(link = \"identity\"),\n  prior(beta(1, 10), class = b, lb = 0, ub = 1),\n  iter = 5000, warmup = 1000, seed = BAYES_SEED,\n  backend = \"rstan\", cores = 4\n)\n## Compiling Stan program...\n## Start sampling\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nmodel_milgram %>% \n  gather_draws(b_Intercept) %>% \n  ggplot(aes(x = .value)) +\n  geom_density(aes(fill = \"Posterior\"), color = NA, alpha = 0.75) +\n  stat_function(geom = \"area\", fun = ~dbeta(., 1, 10), aes(fill = \"Beta(1, 10) prior\"), alpha = 0.75) +\n  scale_fill_manual(values = clrs[5:6]) +\n  xlim(c(0, 1))\n```\n\n::: {.cell-output-display}\n![](03-chapter_files/figure-html/unnamed-chunk-5-1.png){width=672}\n:::\n:::\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}